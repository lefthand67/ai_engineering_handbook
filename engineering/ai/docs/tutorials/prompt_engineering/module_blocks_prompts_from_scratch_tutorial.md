# Создаем модульные промпты с нуля

> Владелец: Вадим Рудаков, lefthand67@gmail.com
> Версия: 0.1.0

Архитектура и гайдлайны нужны, но без рук на клавиатуре всё быстро забудется. Представим, что мы создаём новый кодовый проект, только вместо Python-функций у нас будут *модульные промпты*.

> Внимание! Данное руководство не является промышленным стандартом и не соответствует стандартам нашей организации. Но оно способствует быстрому вхождению в тему создания модульных промптов и на начальных этапах изложенные методы желательно отработать всем.

## План шаг за шагом (с реальными примерами)

### Шаг 1. Создать репозиторий

```bash
mkdir prompt-lab
cd prompt-lab
git init
git switch -c main
```

Добавьте `.gitignore` (например, для временных файлов `.DS_Store`, `__pycache__`, и т.д.).

> Совет: Используйте готовые шаблоны https://www.toptal.com/developers/gitignore

### Шаг 2. Структура папок

```bash
mkdir -p prompts/{system,user,context,docs}
```

* `prompts/system/` — инструкции, роли, формат ответа.
* `prompts/user/` — шаблоны пользовательских запросов.
* `prompts/context/` — блоки с дополнительным знанием.
* `prompts/docs/` — сами гайды о том, *как писать и версионировать промпты*.

### Шаг 3. Первый промпт

Создадим system prompt для обучения:

```yaml
# prompts/system/system_guide_v1.yaml
id: system_guide_v1
content: |
  Ты — AI-наставник, который помогает моей команде учиться писать и версионировать промпты.
  Всегда отвечай структурировано: шаги, примеры, подводные камни.
  Форматируй ответы в markdown.
```

### Шаг 4. Простой user prompt

```yaml
# prompts/user/ask_about_prompts_v1.yaml
id: ask_about_prompts_v1
template: |
  Объясни, как организовать хранение и версионирование промптов в Git.
parameters:
  temperature: 0.2
```

### Шаг 5. Первое комбинирование

Пишем скрипт для сборки финального промпта:

> Внимание! Данный способ не является целевым в нашей организации, но очень полезен для понимания, как собираются модульные промпты. Код ниже не тестировался в реальных условиях, поэтому сообщайте о результатах, кто решится испробовать.

```python
# build_prompt.py
import yaml, sys

def load(file):
    with open(file, "r") as f:
        return yaml.safe_load(f)

system = load("prompts/system/system_guide_v1.yaml")["content"]
user = load("prompts/user/ask_about_prompts_v1.yaml")["template"]

final_prompt = f"{system}\n\n{user}"
print(final_prompt)
```

### Шаг 6. Версионирование и коммиты

```bash
git add .
git commit -m "feat: add first modular prompts for guide use-case"
```

Дальше вы будете делать `git switch -c feature/new-block`, менять/добавлять блоки, а потом через Pull Request обсуждать их в команде.

## Сравнение рабочих стилей

| Подход                         | Что даёт                     | Риски                         |
| ------------------------------ | ---------------------------- | ----------------------------- |
| Всё в одном файле              | Быстрый старт                | Бардак, сложно версионировать |
| Модульные YAML-блоки           | Гибкость, тестируемость      | Нужно писать сборщик          |
| Документы + код (docs + build) | Чёткая методология и примеры | Более высокая кривая входа    |

## Источники для старта

См. `culture/ai/ai_further_reading.md`.

## Почему не годится для прома

* **Слишком быстрый рост блоков** → без правил нейминга (`id`, `v1`, `v2`) вы запутаетесь.
* **Нет автотестов** → ошибка в параметрах (`{text}` без подстановки) всплывёт уже на проде.
* **Ручное комбинирование** → лучше сразу писать скрипты сборки.
* **Нет ревью процессов** → без PR дисциплина быстро рушится.
* **Документы забывают обновлять** → версионируйте сами гайды рядом с промптами.

Подготовлено с помощью ChatGPT.
